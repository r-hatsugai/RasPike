#include "HsvClass.h"

HSV HsvClass::hsv_calculate(rgb_raw_t rgb_val){
    //----------------------------------------------------------------------
    //rgb取得値格納
    //----------------------------------------------------------------------
    R = rgb_val.r;
    G = rgb_val.g;
    B = rgb_val.b;
    //----------------------------------------------------------------------
    //rgbの最大、最小を変数に格納
    //----------------------------------------------------------------------
    MIN = R < G ? R : G;
    MIN = MIN < B ? MIN : B;

    MAX = R > G ? R : G;
    MAX = MAX > B ? MAX : B;

    //----------------------------------------------------------------------
    //最大値をvに格納
    //----------------------------------------------------------------------
    out.V = MAX/256*100;

    //----------------------------------------------------------------------
    //H,Sの計算
    //----------------------------------------------------------------------
    if(MAX==MIN){
        out.H = 0;
        out.S = 0;
    }
    else{
        if(MAX == R) out.H = 60.0*(G-B)/(MAX-MIN) + 0;
        else if(MAX == G) out.H = 60.0*(B-R)/(MAX-MIN) + 120.0;
        else if(MAX == B) out.H = 60.0*(R-G)/(MAX-MIN) + 240.0;

        if(out.H > 360.0) out.H = out.H - 360.0;
        else if(out.H < 0) out.H = out.H + 360.0;
        out.S = (MAX-MIN)/MAX*100.0;
    }

    return out;

}
